#version 120

uniform sampler2D texture;
uniform sampler2D normals;
uniform sampler2D specular;
uniform sampler2D lightmap;

varying vec4 color;
varying vec2 uv;
varying vec2 uvLight;

varying vec3 normal;
varying mat3 tbnMatrix;

varying float smoothness_in;
varying float reflectivity_in;

void main() {
    //color
    gl_FragData[0] = texture2D( texture, uv ) * color;

    //determine material reflectivity and smoothness
    float smoothness = smoothness_in;
    float reflectivity = max( reflectivity_in, texture2D( specular, uv ).r );;

    if(        matID ==   1.0 //stone
            || matID ==  14.0 //gold ore
            || matID ==  15.0 //iron ore
            || matID ==  16.0 //coal ore
            || matID ==  21.0 //lapiz lazuli ore
            || matID ==  56.0 //diamond ore
            || matID ==  73.0 //redstone ore
            || matID == 129.0 //emerald ore
            || matID ==  23.0 //dispenser
            || matID ==  29.0 //sticky piston
            || matID ==  44.0 //slabs
            || matID ==  48 //moss stone
            || matID ==  69 //lever
            || matID ==  70 //stone pressure plate
            || matID ==  77 //button
            || matID ==  93 //redstone repeater
            || matID ==  98 //monster egg
      ) {
        smoothness = 0.2;
        reflectivity = 0.5;
    } else if( matID ==  98 //stone bircks
            ) {
        smoothness = 0.8;
        reflectivity = 0.5;
    } else if( matID ==   4 //cobblestone
            || matID ==  61 //furnace
            || matID ==  67 //stone stairs
            ) {
        smoothness = 0.1;
        reflectivity = 0.5;
    } else if( matID ==   2 //grass
            || matID ==   3 //dirt
            || matID ==   5 //wood planks
            || matID ==  17 //wood
            || matID ==  32 //dead brush
            || matID == 110 //mycelium
            || matID == 162 //other wood ugh
            || matID ==  19 //sponge
            || matID ==  47 //bookshelf
            || matID ==  50 //torch
            || matID ==  53 //wood stairs
            || matID ==  54 //chest
            || matID ==  55 //redstone wire
            || matID ==  58 //crafting table
            || matID ==  60 //farmland
            || matID ==  64 //wooden door
            || matID ==  65 //ladder
            || matID ==  66 //rails
            || matID ==  72 //wood pressure plate
            || matID ==  85 //fence
            || matID == 131 //tripwire hook
            || matID == 132 //tripwire
      ) {
        smoothness = 0.0;
        reflectivity = 0.9;
    } else if( matID ==   7 //bedrock
            || matID ==  18 //leaves
            || matID ==  31 //grass
            || matID ==  37 //dandelion
            || matID ==  38 //poppy
            || matID ==  39 //brown mushroom
            || matID ==  40 //red muchroom
            || matID ==  81 //cactus
            || matID ==  83 //sugar cane
            || matID ==  86 //pumpkin
            || matID ==  99 //huge brown muchroom
            || matID == 100 //huge red muchroom
            || matID == 103 //melon
            || matID == 106 //vines
            || matID == 111 //lily pad
            || matID == 127 //cocoai
            || matID == 161 //other leaves ugh
            || matID == 175 //double plant
            || matID ==  30 //cobweb
            || matID ==  59 //wheat
            || matID == 141 //carrot
            || matID == 142 //wat's taters?
            ) {
        smoothness = 0.5;
        reflectivity = 0.8;
    } else if( matID ==  12 //sand
            || matID ==  78 //snow
            || matID ==  80 //snow block
            ) {
        smoothness = 0.1;
        reflectivity = 0.9;
    } else if( matID ==  13 //gravel
            ) {
        smoothness = 0.4;
        reflectivity = 0.5;
    } else if( matID ==  24 //sandstone
            || matID ==  82 //clay block
            || matID == 159 //stained clay
            || matID == 172 //hardened clay
            || matID ==  52 //monster spawner
            || matID ==  71 //iron door
            || matID == 101 //iron bars
            || matID == 118 //cauldron
            || matID == 120 //end portal
            || matID == 128 //sandstone stairs
            || matID == 140 //flower pot
            || matID ==  49 //obsidian
            ) {
        smoothness = 0.5;
        reflectivity = 0.9;
    } else if( matID ==  79 //ice
            ) {
        smoothness = 0.9;
        reflectivity = 1.0;
    } else if( matID ==  35 //wool
            || matID ==  46 //TNT
            ) {
        smoothness = 0.0;
        reflectivity = 0.2;
    } else if( matID ==  41 //gold block
            || matID ==   8 //water
            || matID == 102 //glass pane
            ) {
        smoothness = 1.0;
        reflectivity = 1.0;
    }

    //skipLighting, torch lighting, isWater, smoothness
    gl_FragData[5] = vec4( 0, texture2D( lightmap, uvLight ).r, 0, smoothness );

    vec3 texnormal = texture2D( normals, uv ).xyz;
    texnormal = tbnMatrix * texnormal;
    //normal, reflectivity
    gl_FragData[2] = vec4( texnormal * 0.5 + 0.5, reflectivity );
}
